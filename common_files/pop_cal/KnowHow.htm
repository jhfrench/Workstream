
<HTML>
<HEAD>
<TITLE>Know How 1001 for CalendarXP</TITLE>
</HEAD>
<BODY>
<H2>Know How 1001 for CalendarXP</H2><FONT color="blue">
<HR width="100%" noshade></FONT>
<P align="right"><FONT color="blue">&nbsp;Updated:&nbsp;26&nbsp;Aug 2001</FONT></P>The 
CalendarXP series are more customizable &amp; versatile than you can imagine. I 
will write down the hints &amp; tips bit by bit, so please check my website 
frequently to get more surprises.
<UL>
	<LI><STRONG>Q:</STRONG><STRONG><EM>How to add a FlatCalendar to my web page?<BR></EM>A:</STRONG>Just add 1 calendar tag to 
  anywhere of&nbsp;your webpage, nothing else. And it&nbsp;turns into&nbsp;a beautiful calendar in your browser.&nbsp;MAGIC!?!&nbsp; ^_^ See the Template.htm for a
            quick sample.<BR>i.e.<BR><FONT color="red">&lt;iframe 
  name="gToday:normal:agenda.js" id= 
  "gToday:normal:agenda.js" src=  
    "flatcjs.htm" frameborder=    "2" scrolling= "no" style= 
             "border:ridge;"&gt;&lt;/iframe&gt;</FONT><BR><BR>
	<LI><STRONG>Q:</STRONG><STRONG><EM>How do I make the calendar function under Netscape 4.x?<BR></EM>A:</STRONG>After your payment you will receive a full version package with additional script files by email. You don't need to change any
            current setting of your calendar if you've already put one in use. Just copy the necessary files (except themes &amp; agenda) to the directory of
            your calendar and modify the calendar tag a little in your web page. That is all. The&nbsp;details can be&nbsp;found from the demo&nbsp;source&nbsp;in the&nbsp;developing
            package.<BR><BR>
	<LI><STRONG>Q:</STRONG><STRONG><EM>How can I&nbsp;connect the calendar&nbsp;agendas to my database?<BR></EM>A:</STRONG>Depends on the&nbsp;CGI you are using, the solution&nbsp;might be a little different. But&nbsp;the basic idea is to&nbsp;make your CGI treat agenda.js
            as a special CGI program so that the request to the web server&nbsp;will be direct to&nbsp;your CGI and let your CGI program generate the contents of&nbsp;it. Let
            me show you an example on Tomcat with JSP engine:
	<OL>
		<LI>Let your Java programmer take the agenda.js file and code database scripts in it as if it&nbsp;was a JSP file. Assume the agenda table in your
                  database has these columns [ag_date, ag_msg, ag_color, ag_action, ag_imageurl]. A quick example will be:<BR><FONT color="red">&lt;%@ page 
    contentType="text/javascript" %&gt;<BR>// == This file is fully configurable ==<BR>/*** Default Action when you click a normal date ***/<BR>var gsAction=" ";&nbsp;// You may even use self-defined function here. i.e. gsAction="fDemo()";<BR>&lt;% {connecting database and retrieve the agendas into a resultset: agendars} %&gt;&lt; br&gt;&lt;% while (agendars.next()){%&gt;<BR>addEvent("&lt;%=agendars.getString("ag_date")%&gt;","("&lt;%=agendars.getString("ag_msg")%&gt;","("&lt;%=agendars.getString("ag_color")%&gt;","("&lt;%=agendars.getString("ag_action")%&gt;","("&lt;%=agendars.getString("ag_imageurl")%&gt;");<BR>&lt;% } agendars.getStatement().close(); %&gt;</FONT>
		<LI>Change the file name from<FONT color="red">agenda.js</FONT>to<FONT color="red">agenda.js.jsp</FONT>and the&nbsp;3rd portion of your
                  calendar tag's name as well.&nbsp;</LI>
	</OL>	Now&nbsp;the calendar will&nbsp;get the agendas from DB&nbsp;automatically. ^_^<BR><BR>
	<LI><STRONG>Q:</STRONG><STRONG><EM>Can I display the calendar on my Windows Desktop?<BR></EM>A: YES!</STRONG>This effect works on Windows with the Active Desktop support enabled (usually by upgrading your IE to 5.0). Just follow
            these steps:
	<OL>
		<LI>Right-click on your windows desktop and select 
    "Properties".
		<LI>Select the "Web" panel and check the "View active 
    desktop as web pages". Uncheck the other items in the list.
		<LI>Click the "New" button to locate the desktopdemo.htm in 
    FlatCalendarXP.
		<LI>Click "OK" and resize the container of the calendar to a size that no scroll-bar comes out.</LI>
	</OL>	Now you can arrange your daily agendas on your desktop gracefully! Send us an email compliment if you like.&nbsp;<BR><BR>
	<LI><STRONG>Q:<EM>I like the Active Desktop trick, but can I have it automatically notify me of pending events everyday?<BR></EM>A:</STRONG>Add the following line to the calendar tag in desktopDemo.htm:<BR><FONT color="red">onload="with(frames[0])eval(fGetAgenda(gToday)[2])"</FONT>&nbsp;<BR><BR>
	<LI><STRONG>Q:<EM>I noticed the tooltip is not always pop-up when I put the calendar on my desktop. What's wrong?<BR></EM>A:</STRONG>That&nbsp;will happen when the&nbsp;containing window cannot get focused.&nbsp;Add the following line to the calendar tag in desktopDemo.htm
            to&nbsp;solve it:<BR><FONT color="red">onmouseover="self.focus()"</FONT><BR>i.e.<BR><FONT color="red">&lt;iframe name="gToday:normal:agenda.js" id="gToday:normal:agenda.js" src="flatcjs.htm" frameborder="2" scrolling="no"
            style="border:ridge;" onmouseover="self.focus()" onload="with(frames[0])eval(fGetAgenda(gToday)[2])"&gt;&lt;/iframe&gt;</FONT><BR><BR>
	<LI><STRONG>Q:<EM>How do I change the default month that is shown on the very beginning?<BR></EM>A:</STRONG>Change the first part (separated by colons) of the name of the calendar tag to any month using the [year,month] format. You can
            also use the predefined "gToday" word to set it to current month. See the source code of demo file for examples.<BR><BR>
	<LI><STRONG>Q:<EM>How do I switch between the different themes for my calendar?<BR></EM>A:</STRONG>As easy as configuring the second part (separated by colons) of the name of the calendar tag to the theme's name. A theme
            consists of two files with the same name but different suffix.&nbsp;For example,&nbsp;the "normal" theme is made up of normal.css and normal.js.<BR><BR>
	<LI><STRONG>Q:<EM>How are the options &amp; agendas of the calendar configured?<BR></EM>A:</STRONG>Go into the theme files (.css and .js), modify the options inside according to the comments. Go into the agenda.js file for the
            events &amp; holiday plug-in. Note that you may even have different agenda files for different calendars in one page! Just set them in the third
            part (separated by colons) of the name of your calendar tags!&nbsp;<BR><BR>
	<LI><STRONG>Q:<EM>How to create a beautiful wall calendar?<BR></EM>A:</STRONG>All you need is FlatCalendarXP 3.20, a printer and several images which can be downloaded from Internet or self-made. Then
            following the steps:
	<OL>
		<LI>Decide the calendar size and look by defining the two 
    theme file - normal.css and normal.js.d
		<LI>Customize the desktopdemo.htm file to add some 
    surrounding decorations around you calendar if you like.
		<LI>Define the agenda.js file with the holiday, 
    anniversary or celebration highlights or images.
		<LI>Change the name of the calendar tag to the month that 
    you want to print.&nbsp;i.e. "[2001,6]:normal:agenda.js".
		<LI>Start desktopdemo.htm in a browser and select "print" from file menu.</LI>
	</OL>	Don't hate us if you become a distributor of wall calendars to your family and friends. ^_^<BR><BR>
	<LI><STRONG>Q:<EM>How do I leave out the days that are not in the current month?<BR></EM>A:</STRONG>Go into the fHoliday() function in your agenda.js file, remove the //&nbsp;before the&nbsp;2nd line. That will give you this special
            effect.<BR><BR>
	<LI><STRONG>Q:<EM>How to cross-over the past date?<BR></EM>A:</STRONG>Go into the fHoliday() function in your agenda.js file, remove the //&nbsp;before the 3rd line. That will give you this special
            effect.<BR><BR>
	<LI><STRONG>Q:<EM>How to show a webpage in a designated frame when a date is clicked?<BR></EM>A:</STRONG>Use<FONT color="red">"popup('pageurl','framename')"</FONT>as your agenda's action.<BR><BR>
	<LI><STRONG>Q:<EM>How to align the date number within the calendar cell?<BR></EM>A:</STRONG>Go to the themename.css file and find the .CalCell class, change the value of "text-align" to left, center or right.&nbsp;<BR><BR>
	<LI><STRONG>Q:<EM>How to hide the popped-up calendar when I click elsewhere of the page?<BR></EM>A:</STRONG>Put the following scripts at the bottom of your page:<BR><FONT color="red">&lt;script&gt;document.onclick= function(e){vart=(!e)?self.event.srcElement.value:e.target.value;if(t!=" V ")
            gfPop.fHideCal();}&lt;/script&gt;</FONT><BR><BR>
	<LI><STRONG>Q:</STRONG><STRONG><EM>How to hide the popped-up calendar when I resizing the browser?<BR></EM>A:</STRONG>Put the following scripts at the bottom of your page:<BR><FONT color="red">&lt;script&gt;self.onresize= function(){gfPop.fHideCal();}&lt;/script&gt;</FONT><BR><BR>
	<LI><STRONG>Q:<EM>How to have PopCalendarXP controls with different agenda or themes on one page?<BR></EM>A:</STRONG>Define more than one calendar-tag on this page with different themes or agenda name, and most important -- set the control name
            in the 4th portion of the calendar-tag's name.&nbsp;&nbsp;<BR><FONT color="red">&lt;body&gt;</FONT><BR><FONT color="red">....<BR>&lt;!-- PopCalendar Area 
  --&gt;<BR>&lt;iframe name="gToday:theme1:agenda1.js:gfPop1" id="gToday:theme1:agenda1.js:gfPop1" src="popcjs.htm" frameborder="2"
            scrolling="no" style="border:ridge;visibility:hidden;position:absolute;z-index:65535"&gt;&lt;/iframe&gt;<BR>&lt;iframe name="gToday:theme2:agenda2.js:gfPop2" id="gToday:theme2:agenda2.js:gfPop2" src="popcjs.htm" frameborder="2" scrolling="no"
            style="border:ridge;visibility:hidden;position:absolute;z-index:65535"&gt;&lt;/iframe&gt;<BR>&lt;/body&gt;</FONT><BR>And then use "<FONT color="red">gfPop1.PopCalendar()</FONT>" &amp; "<FONT color="red">gfPop2.PopCalendar()</FONT>" accordingly in your date control scripts.<BR><STRONG><BR></STRONG>
	<LI><STRONG>Q:</STRONG><STRONG><EM>How can I avoid seeing the FlatCalendar inflating itself everytime the 
  page loading?<BR></EM>A:</STRONG>Just preset the calendar tag's dimension 
  parameters to a proper value by adding the "width" and "height" to 
  the tag. You need to fine-tune the values until no visual inflating during 
  page loading.<BR>i.e.<BR><FONT color="red">&lt;iframe name="gToday:normal:agenda.js" id= 
   "gToday:normal:agenda.js" 
  src= 
  "flatcjs.htm" frameborder= "2" scrolling= 
      "no" style= "border:ridge;" 
  width=183 height=209&gt;&lt;/iframe&gt;</FONT><BR><BR><STRONG></STRONG>
	<LI><STRONG>Q:</STRONG><STRONG><EM>I have a heavy-load page. Can I speed up 
  the PopCalendar loading?<BR></EM>A:</STRONG>Yes! 
  Move the &lt;iframe&gt; calendar tags 
  from the bottom of the page to the top, just below the &lt;body&gt; tag. Be 
  careful&nbsp;not moving the NN4 engine tag, because doing so will generally cause 
  trouble.<BR><BR>
	<LI><STRONG>Q:</STRONG><STRONG><EM>How can I replace the ugly "V" button with 
  a nice image for the PopCalendar?<BR></EM>A:</STRONG>Well, is it so ugly? ;-) Anyway, you can 
  use an &lt;IMG&gt; tag or any tag you prefer to replace the &lt;INPUT&gt; tag. 
  The only key is the onclick event, no magic! But be sure the parameter passed 
  in is correct within the context. i.e. The "this.form" is only eligible for 
  &lt;INPUT&gt;, for other tags use "document.formname" instead.<BR><STRONG><BR></STRONG>
	<LI><STRONG>Q:</STRONG><STRONG><EM>How can I use the wonderful FlatCalendar 
  themes for the PopCalendar?<BR></EM>A:</STRONG>Well, it's no problem at all. 
  The themes of the two products are exchangable since version 3.54. So it's 
  just&nbsp;as easy as take-and-use. ^)^<BR><BR>
	<LI><STRONG>Q:</STRONG><STRONG><EM>How can I make the event popup window go 
  to the&nbsp;top everytime?<BR></EM>A:</STRONG>In agenda.js file, add the following 
  codes and replace all the "popup(xxx)" with "pop(xxx)".<BR><FONT color="red">function pop(url) {<BR>&nbsp; var w = 
  parent.open(url,null,gsPopConfig);<BR>&nbsp; if (w) w.focus();<BR>}<BR></FONT>Note: This 
  bug has been fixed since version 4.10, but&nbsp;it is a 
  good example to show you that you can use self-defined functions to config the 
  calendar's behaviors without modifying the code engine!! Take a good look at 
  PopCalendar's powerful demo for more interesting ideas. ^_^<BR><BR>
  <LI><STRONG>Q:</STRONG><STRONG><EM>How can I&nbsp;show&nbsp;the FlatCalendar with offset relatively to 
  its currenty position?<BR></EM>A:</STRONG>Simply&nbsp;add the "<FONT color="red">position:relative;left:&lt;leftoffset&gt;;top:&lt;topoffset&gt;;</FONT>" 
  to the style of &lt;iframe&gt;, and "<FONT color="red">top=&lt;topoffset&gt; 
  left=&lt;leftoffset&gt;</FONT>" to the &lt;ilayer&gt; tag.<BR><BR>
  <LI><STRONG>Q:</STRONG><STRONG><EM>How can I remove&nbsp;the outside border of 
  calendar in IE&amp;NN6?<BR></EM>A:</STRONG>Simply&nbsp;remove the 
  "<FONT color="red">border:ridge;</FONT>" from the style of &lt;iframe&gt; 
  tag and set "<FONT color=#ff0000>frameborder=0</FONT>".<BR><BR>
  <LI><STRONG>Q:</STRONG><STRONG><EM>How can I get the calendar centered when it goes beyond the border of browser?<BR></EM>A:</STRONG>Add a self-defined function as following to the agenda.js file, and call it in your HTML page instead of fPopCalendar()<BR><FONT color="red">
  function fMyPop(a,b,c,d) {<BR> if (!document.layers) {var p=fGetXY(a);parent.scrollTo(p[0]-20,p[1]-20);}<BR>
  fPopCalendar(a,b,c,d);<BR>
  }</FONT><BR>Note: this code won't work for NN4, but you've got the idea and may code one by yourself.<BR><BR>
<LI><STRONG>Q:</STRONG><STRONG><EM>How can I get the FlatCalendar auto-switched to the prev/next month when the user clicked on the dates of prev/next month?<BR></EM>A:</STRONG>Append a self-defined function as following to the agenda.js file, and set the value of "gsAction" to "fAutoSwitch(y,m);".<BR><FONT color="red">
  function fAutoSwitch(y,m) {<BR>   if (m!=gCurMonth[1]) fSetCal(y,m);<BR>}</FONT><BR><BR></LI>

</UL>
</BODY>
</HTML>
